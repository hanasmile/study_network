# Chapter08.네트워크 전체 흐름 살펴보기

- [랜카드에서의 데이터 전달과 처리](#%EF%B8%8F-랜카드에서의-데이터-전달과-처리)
- [스위치와 라우터에서의 데이터 전달과 처리](#%EF%B8%8F-스위치와-라우터에서의-데이터-전달과-처리)
- [웹 서버의 데이터 전달과 처리](#%EF%B8%8F-웹-서버의-데이터-전달과-처리)

 
<br>

## 💡 랜카드에서의 데이터 전달과 처리
> 물리계층에서는 데이터를 전기신호로 변환하고, 데이터 링크 계층에서는 랜에서 데이터를 송수신하는데 필요하다. 네트워크 계층에서는 다른 네트워크에 있는 목적지에 도달하기 위해 역할을하고, 전송 계층은 목적지에 데이터를 정확하게 전달하기위해 필요하다. 응용 계층에서는 애플리케이션에서 데이터를 송순시하는데 필요한 기능을 가지고 있다.


### 추가적인 내용 기술
- 웹 브라우저에서 URL을 입력하고 엔터를 누르면, 응용계층에서 HTTP 프로토콜이 html 데이터를 얻기 위해 HTTP 메시지(GET 요청)를 생성한다.
- 이 캡슐화된 데이터가 전송 계층에 전달되 TCP 헤더가 장착되어 캡슐화가 일어난다. 이 때 TCP 헤더에는 출발지 포트(무작위 선택)와 목적지 포트(80번 포트)가 담겨있다. 이 TCP 헤더가 붙은 데이터를 TCP 세그먼트라 한다.
- 이후 네트워크 계층으로 전달되어 IP 헤더가 장착된다. 이 IP 헤더에는 출발지 IP와 목적지 IP가 담겨 있다. 이를 캡슐화한 데이터를 IP 패킷이라 부른다.
- 이제 데이터 링크 계층으로 전달되어 이더넷 헤더가 붙는다. 이를 이더넷 프레임이라 한다.
- 그 다음 물리 계층으로 전달되어 전기 신호로 변환되어 네트워크로 전달된다. 이 때 전기신호로 변환시키는 네트워크 장비는 랜 카드이다.


<br>

## 💡 스위치와 라우터에서의 데이터 전달과 처리
> 스위치에 대응되는 OSI 모델의 계층은 물리 계층과 데이터 링크 계층이고, 라우터에 대응되는 계층은 물리 계층, 데이터 링크 계층, 네트워크 계층이다.


### 추가적인 내용 기술
- 스위치의 데이터 링크 계층의 데이터를 물리계층으로 전달하여 전기 신호로 변환하여 라우터로 전송한다.
- 전기신호로 스위치에서 라우터로 전송된 데이터는 라우터의 데이터 링크 계층에서 이더넷 프레임에 담긴 목적지 MAC주소와 자신의 MAC주소를 비교한다. 이 때 목적지 MAC주소와 자신의 MAC주소가 같으면 이더넷 헤더와 트레일러를 분리하는 역캡슐화를 진행한다.
- 다음 상위계층인 네트워크 계층으로 전달되어 라우팅 테이블을 통해 목적지 IP의 주소를 비교하게 된다.
- 비교 후, 네트워크 계층에서는 현재 출발지 IP주소를 라우터의 외부 IP주소(WAN)로 변경한 다음 데이터 계층, 물리계층으로 전달하여 다음 라우터로 이동할 수 있게 캡슐화가 이뤄진다.
- 두번째 라우터도 목적지의 네트워크가 자신의 네트워크인지 확인하기 위해 첫번째 라우터처럼 역캡슐화를 진행한다.
- 해당 네트워크로 도달하면, 라우터에서는 스위치로 전달하고 스위치의 데이터 링크 계층에서 웹 서버에 데이터를 전달한다.![](https://images.velog.io/images/jewon119/post/b2d0fda2-5146-4c5e-996f-a529ae090477/IMG_0434.jpeg)

<br>


## 💡 웹 서버의 데이터 전달과 처리
>  웹 서버 내에 해당하는 OSI 모델 계층은 물리 계층, 데이터링크 계층, 네트워크 계층, 전송 계층, 응용 계층이다.


### 추가적인 내용 기술
- 데이터가 전기신호로 웹 서버에 도착하면 웹 서버는 데이터 링크 계층에서 이더넷 프레임의 목적지 MAC 주소와 자신의 MAC주소를 비교한다. 주소가 같으면, 이더넷 헤더와 트레일러를 분리하고 네트워크 계층에 전달한다.
- 네트워크 계층에서는 목적지 IP와 웹 서버의 IP주소가 같은지 확인하고, 같으면 IP헤더를 분리해서 전송 계층에 전달한다.
- 전송계층에서는 목적지 포트 번호를 확인하여 어떤 애플리케이션으로 전달해야할지 판단하고 TCP 헤더를 분리하여 응용계층으로 전달한다.![](https://images.velog.io/images/jewon119/post/ec5bafb4-f4ae-45ae-87fc-ae39b032cddb/IMG_0446.jpeg)